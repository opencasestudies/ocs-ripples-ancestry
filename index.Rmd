---
title: "Ripples Ancestry Plot"
author: "Kate Isaac"
date: "2024-12-20"
output: html_document
---

```{r}
library(readr)
library(ggplot2)
library(tidyverse)

ancestry_props <- read_delim("~/Documents/resources/papers/ripples/NC.admixture_results.with_fam.Q", col_names = FALSE, delim=" ")
colnames(ancestry_props) <- c("pop", "id", paste0("k", c(2:7)))
ancestry_props <- ancestry_props %>%
  separate(col = id, into = c("id", "k1"), sep="\t") %>%
  mutate(k1 = as.double(k1))

```
Need to add superpopulation labels and sort by those.


```{r}
ancestry_props %>% 
  pivot_longer(starts_with("k"), values_to = "prop", names_to = "which_k") %>%
  ggplot(aes(y=id,
             x=prop,
             fill = which_k,
             group = pop)) +
  geom_bar(stat = "identity", position = "stack") +
  facet_wrap(~pop, ncol=1, strip.position = "left", scale = "free_y") +
  theme(axis.text.y = element_blank(),
        strip.text.y.left = element_text(angle = 0)) +
  ylab("")

```